{% extends 'base/base.html' %}
{% load static %}

{% block link %}
    <script defer src="{% static 'cart/js/cart.js' %}"></script>
    <script defer src="{% static 'cart/js/plus_count.js' %}"></script>
    <script defer src="{% static 'cart/js/minus_count.js' %}"></script>
    <script defer src="{% static 'cart/js/delete_product.js' %}"></script>
    <link rel="stylesheet" href="{% static 'cart/css/cart.css' %}">
{% endblock %}


{% block main %}
<!-- row justify-content-center align-items-center content mt-4 h-100 -->
    <div class="content">

        <!-- <div class="col-1"></div> -->
        <!-- col-10 d-flex justify-content-start gap-3 flex-wrap ps-3  -->
        <div class="error_empty">
            <h2>Кошик порожній!</h2>
            <img src="{% static 'cart/icons/cart.svg' %}" alt="">
        </div>
        <div class="products">

            <!-- d-flex flex-column align-items-center -->
            
            {% for product_in_cart in products %}
            <!-- d-flex align-items-center py-3 mb-3 shadow  -->
                <div class="card_{{product_in_cart.product_id}}_{{product_in_cart.flavour_id}} product_card product_{{product.id}}_{{product_in_cart.flavour_id}}">
                    {% for flavour in flavours %}
                        {% if flavour.id == product_in_cart.flavour_id %}
                        <!-- w-75 m-1  -->
                            
                            <img src="{{flavour.image.url}}" alt="" class="image_flavour{{product_in_cart.product_id}}">
                        {% endif %}
                    {% endfor %}
                    
                    <h5>{{product_in_cart.product.name}}</h5>
                    {% for price in prices %}
                        {% if forloop.counter0 == forloop.parentloop.counter0 %}
                            <p id="price_{{product_in_cart.product_id}}_{{product_in_cart.flavour_id}}">{{price}} грн</p>
                        {% endif %}
                    {% endfor %}

                    {% for flavour in flavours %}
                        {% if flavour.id == product_in_cart.flavour_id %}
                            <p id="flavour_name">{{flavour.name}}</p>
                        {% endif %}
                    {% endfor %}
                    <!-- d-flex gap-1 mb-2 -->
                    <div class="count_div">
                        <form method="POST">
                            {% csrf_token %}
                            {% for flavour in flavours %}
                                {% if flavour.id == product_in_cart.flavour_id %}
                                    <input type="hidden" value="{{flavour.id}},{{flavour.for_product.id}}" name="minus" class="minus_input_hidden_{{flavour.for_product.id}}">
                                {% endif %}
                            {% endfor %}
                            <!-- btn btn-outline-secondary  -->
                            <button class="minus" value="{{product_in_cart.flavour_id}},{{product_in_cart.product_id}}">-</button>
                        </form>
                        <!-- p-2 d-flex align-items-center rounded -->
                        <div class="count product_count_{{product_in_cart.product_id}}_{{product_in_cart.flavour_id}}">Кількість: {{product_in_cart.count}}</div>
                        <form method="POST">
                            {% csrf_token %}
                            {% for flavour in flavours %}
                                {% if flavour.id == product_in_cart.flavour_id %}
                                    <input type="hidden" value="{{flavour.id}},{{flavour.for_product.id}}" name="plus" class="plus_input_hidden_{{flavour.for_product.id}}">
                                {% endif %}
                            {% endfor %}
                            <!-- btn btn-outline-secondary  -->
                            <button class="plus" value="{{product_in_cart.flavour_id}},{{product_in_cart.product_id}}">+</button>
                        </form>
        
                        
                    </div>
                    <div class="delete_div">
                        <form method="POST">
                            {% csrf_token %}
                            {% for flavour in flavours %}
                                {% if flavour.id == product_in_cart.flavour_id %}
                                    <input type="hidden" value="{{flavour.id}},{{flavour.for_product.id}}" name="delete" class="delete_input_hidden_{{flavour.for_product.id}}">
                                {% endif %}
                            {% endfor %}
                            <!-- btn btn-secondary  -->
                            <button class="delete" value="{{product_in_cart.flavour_id}},{{product_in_cart.product_id}}">Видалити</button>
                        </form>
                    </div>
                    

                </div>
            {% endfor %}
        </div>

    </div>
    {% if products %}
    <!-- row justify-content-center align-items-center content my-4 -->
        <!-- <div class="make_order"> -->
            <a href="{% url 'order' %}" class="make_order">Замовити</a>
        <!-- </div> -->
    {% endif %}
    </div>
{% endblock main %}