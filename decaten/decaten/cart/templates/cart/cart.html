{% extends 'base/base.html' %}
{% load static %}

{% block link %}
    <script defer src="{% static 'cart/js/cart.js' %}"></script>
    <script defer src="{% static 'cart/js/plus_count.js' %}"></script>
    <script defer src="{% static 'cart/js/minus_count.js' %}"></script>
    <script defer src="{% static 'cart/js/delete_product.js' %}"></script>

{% endblock %}


{% block main %}
    <div class="w-100 h-100 d-flex gap-4 justify-content-center align-items-center content">
        {% if not products %}
            <div class="d-flex flex-column align-items-center">
                <h2>Кошик порожній!</h2>
                <img src="{% static 'cart/icons/cart.svg' %}" alt="" style="width: 200px;">
            </div>
            
        {% endif %}
        {% for product_in_cart in products %}
            <div style="border: 1px solid red; padding: 10px; border-radius: 15px; margin-bottom: 10px;" class="card_{{product_in_cart.product_id}}">
                {% for flavour in flavours %}
                    {% if flavour.id == product_in_cart.flavour_id %}
                        <img src="{{flavour.image.url}}" alt="" width="200px" class="image_flavour{{product_in_cart.product_id}}">
                    {% endif %}
                {% endfor %}
                
                <h1>{{product_in_cart.product.name}}</h1>
                <p>{{product_in_cart.product.price}} грн</p>
                <h4 class="product_count_{{product_in_cart.product_id}}">{{product_in_cart.count}}</h4>
                {% for flavour in flavours %}
                    {% if flavour.id == product_in_cart.flavour_id %}
                        <h4>{{flavour.name}}</h4>
                    {% endif %}
                {% endfor %}
                
                <form method="POST">
                    {% csrf_token %}
                    {% for flavour in flavours %}
                        {% if flavour.id == product_in_cart.flavour_id %}
                            <input type="hidden" value="{{flavour.id}},{{flavour.for_product.id}}" name="minus" class="minus_input_hidden_{{flavour.for_product.id}}">
                        {% endif %}
                    {% endfor %}
                    <button class="minus" value="{{product_in_cart.flavour_id}},{{product_in_cart.product_id}}">-</button>
                </form>

                <form method="POST">
                    {% csrf_token %}
                    {% for flavour in flavours %}
                        {% if flavour.id == product_in_cart.flavour_id %}
                            <input type="hidden" value="{{flavour.id}},{{flavour.for_product.id}}" name="plus" class="plus_input_hidden_{{flavour.for_product.id}}">
                        {% endif %}
                    {% endfor %}
                    <button class="plus" value="{{product_in_cart.flavour_id}},{{product_in_cart.product_id}}">+</button>
                </form>

                <form method="POST">
                    {% csrf_token %}
                    {% for flavour in flavours %}
                        {% if flavour.id == product_in_cart.flavour_id %}
                            <input type="hidden" value="{{flavour.id}},{{flavour.for_product.id}}" name="delete" class="delete_input_hidden_{{flavour.for_product.id}}">
                        {% endif %}
                    {% endfor %}
                    <button class="delete" value="{{product_in_cart.flavour_id}},{{product_in_cart.product_id}}">delete</button>
                </form>

            </div>
        {% endfor %}
    </div>
{% endblock main %}